{"ast":null,"code":"import { __awaiter, __generator } from \"tslib\";\nimport { MissingPageContentsEmbeddingError, UnrecognizedStreamTypeError } from \"../errors\";\nimport PDFNumber from \"../objects/PDFNumber\";\nimport PDFRawStream from \"../objects/PDFRawStream\";\nimport PDFStream from \"../objects/PDFStream\";\nimport { decodePDFRawStream } from \"../streams/decode\";\nimport PDFContentStream from \"../structures/PDFContentStream\";\nimport CharCodes from \"../syntax/CharCodes\";\nimport { mergeIntoTypedArray } from \"../../utils\";\nvar fullPageBoundingBox = function (page) {\n  var mediaBox = page.MediaBox();\n  var width = mediaBox.lookup(2, PDFNumber).asNumber() - mediaBox.lookup(0, PDFNumber).asNumber();\n  var height = mediaBox.lookup(3, PDFNumber).asNumber() - mediaBox.lookup(1, PDFNumber).asNumber();\n  return {\n    left: 0,\n    bottom: 0,\n    right: width,\n    top: height\n  };\n};\n// Returns the identity matrix, modified to position the content of the given\n// bounding box at (0, 0).\nvar boundingBoxAdjustedMatrix = function (bb) {\n  return [1, 0, 0, 1, -bb.left, -bb.bottom];\n};\nvar PDFPageEmbedder = /** @class */function () {\n  function PDFPageEmbedder(page, boundingBox, transformationMatrix) {\n    this.page = page;\n    var bb = boundingBox !== null && boundingBox !== void 0 ? boundingBox : fullPageBoundingBox(page);\n    this.width = bb.right - bb.left;\n    this.height = bb.top - bb.bottom;\n    this.boundingBox = bb;\n    this.transformationMatrix = transformationMatrix !== null && transformationMatrix !== void 0 ? transformationMatrix : boundingBoxAdjustedMatrix(bb);\n  }\n  PDFPageEmbedder.for = function (page, boundingBox, transformationMatrix) {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2 /*return*/, new PDFPageEmbedder(page, boundingBox, transformationMatrix)];\n      });\n    });\n  };\n  PDFPageEmbedder.prototype.embedIntoContext = function (context, ref) {\n    return __awaiter(this, void 0, void 0, function () {\n      var _a, Contents, Resources, decodedContents, _b, left, bottom, right, top, xObject;\n      return __generator(this, function (_c) {\n        _a = this.page.normalizedEntries(), Contents = _a.Contents, Resources = _a.Resources;\n        if (!Contents) throw new MissingPageContentsEmbeddingError();\n        decodedContents = this.decodeContents(Contents);\n        _b = this.boundingBox, left = _b.left, bottom = _b.bottom, right = _b.right, top = _b.top;\n        xObject = context.flateStream(decodedContents, {\n          Type: 'XObject',\n          Subtype: 'Form',\n          FormType: 1,\n          BBox: [left, bottom, right, top],\n          Matrix: this.transformationMatrix,\n          Resources: Resources\n        });\n        if (ref) {\n          context.assign(ref, xObject);\n          return [2 /*return*/, ref];\n        } else {\n          return [2 /*return*/, context.register(xObject)];\n        }\n        return [2 /*return*/];\n      });\n    });\n  };\n  // `contents` is an array of streams which are merged to include them in the XObject.\n  // This methods extracts each stream and joins them with a newline character.\n  PDFPageEmbedder.prototype.decodeContents = function (contents) {\n    var newline = Uint8Array.of(CharCodes.Newline);\n    var decodedContents = [];\n    for (var idx = 0, len = contents.size(); idx < len; idx++) {\n      var stream = contents.lookup(idx, PDFStream);\n      var content = void 0;\n      if (stream instanceof PDFRawStream) {\n        content = decodePDFRawStream(stream).decode();\n      } else if (stream instanceof PDFContentStream) {\n        content = stream.getUnencodedContents();\n      } else {\n        throw new UnrecognizedStreamTypeError(stream);\n      }\n      decodedContents.push(content, newline);\n    }\n    return mergeIntoTypedArray.apply(void 0, decodedContents);\n  };\n  return PDFPageEmbedder;\n}();\nexport default PDFPageEmbedder;","map":{"version":3,"names":["__awaiter","__generator","MissingPageContentsEmbeddingError","UnrecognizedStreamTypeError","PDFNumber","PDFRawStream","PDFStream","decodePDFRawStream","PDFContentStream","CharCodes","mergeIntoTypedArray","fullPageBoundingBox","page","mediaBox","MediaBox","width","lookup","asNumber","height","left","bottom","right","top","boundingBoxAdjustedMatrix","bb","PDFPageEmbedder","boundingBox","transformationMatrix","for","_a","prototype","embedIntoContext","context","ref","Contents","Resources","decodedContents","_b","xObject","_c","normalizedEntries","decodeContents","flateStream","Type","Subtype","FormType","BBox","Matrix","assign","register","contents","newline","Uint8Array","of","Newline","idx","len","size","stream","content","decode","getUnencodedContents","push","apply"],"sources":["E:/PROA/frontPROA/node_modules/pdf-lib/es/core/embedders/PDFPageEmbedder.js"],"sourcesContent":["import { __awaiter, __generator } from \"tslib\";\nimport { MissingPageContentsEmbeddingError, UnrecognizedStreamTypeError, } from \"../errors\";\nimport PDFNumber from \"../objects/PDFNumber\";\nimport PDFRawStream from \"../objects/PDFRawStream\";\nimport PDFStream from \"../objects/PDFStream\";\nimport { decodePDFRawStream } from \"../streams/decode\";\nimport PDFContentStream from \"../structures/PDFContentStream\";\nimport CharCodes from \"../syntax/CharCodes\";\nimport { mergeIntoTypedArray } from \"../../utils\";\nvar fullPageBoundingBox = function (page) {\n    var mediaBox = page.MediaBox();\n    var width = mediaBox.lookup(2, PDFNumber).asNumber() -\n        mediaBox.lookup(0, PDFNumber).asNumber();\n    var height = mediaBox.lookup(3, PDFNumber).asNumber() -\n        mediaBox.lookup(1, PDFNumber).asNumber();\n    return { left: 0, bottom: 0, right: width, top: height };\n};\n// Returns the identity matrix, modified to position the content of the given\n// bounding box at (0, 0).\nvar boundingBoxAdjustedMatrix = function (bb) { return [1, 0, 0, 1, -bb.left, -bb.bottom]; };\nvar PDFPageEmbedder = /** @class */ (function () {\n    function PDFPageEmbedder(page, boundingBox, transformationMatrix) {\n        this.page = page;\n        var bb = boundingBox !== null && boundingBox !== void 0 ? boundingBox : fullPageBoundingBox(page);\n        this.width = bb.right - bb.left;\n        this.height = bb.top - bb.bottom;\n        this.boundingBox = bb;\n        this.transformationMatrix = transformationMatrix !== null && transformationMatrix !== void 0 ? transformationMatrix : boundingBoxAdjustedMatrix(bb);\n    }\n    PDFPageEmbedder.for = function (page, boundingBox, transformationMatrix) {\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                return [2 /*return*/, new PDFPageEmbedder(page, boundingBox, transformationMatrix)];\n            });\n        });\n    };\n    PDFPageEmbedder.prototype.embedIntoContext = function (context, ref) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, Contents, Resources, decodedContents, _b, left, bottom, right, top, xObject;\n            return __generator(this, function (_c) {\n                _a = this.page.normalizedEntries(), Contents = _a.Contents, Resources = _a.Resources;\n                if (!Contents)\n                    throw new MissingPageContentsEmbeddingError();\n                decodedContents = this.decodeContents(Contents);\n                _b = this.boundingBox, left = _b.left, bottom = _b.bottom, right = _b.right, top = _b.top;\n                xObject = context.flateStream(decodedContents, {\n                    Type: 'XObject',\n                    Subtype: 'Form',\n                    FormType: 1,\n                    BBox: [left, bottom, right, top],\n                    Matrix: this.transformationMatrix,\n                    Resources: Resources,\n                });\n                if (ref) {\n                    context.assign(ref, xObject);\n                    return [2 /*return*/, ref];\n                }\n                else {\n                    return [2 /*return*/, context.register(xObject)];\n                }\n                return [2 /*return*/];\n            });\n        });\n    };\n    // `contents` is an array of streams which are merged to include them in the XObject.\n    // This methods extracts each stream and joins them with a newline character.\n    PDFPageEmbedder.prototype.decodeContents = function (contents) {\n        var newline = Uint8Array.of(CharCodes.Newline);\n        var decodedContents = [];\n        for (var idx = 0, len = contents.size(); idx < len; idx++) {\n            var stream = contents.lookup(idx, PDFStream);\n            var content = void 0;\n            if (stream instanceof PDFRawStream) {\n                content = decodePDFRawStream(stream).decode();\n            }\n            else if (stream instanceof PDFContentStream) {\n                content = stream.getUnencodedContents();\n            }\n            else {\n                throw new UnrecognizedStreamTypeError(stream);\n            }\n            decodedContents.push(content, newline);\n        }\n        return mergeIntoTypedArray.apply(void 0, decodedContents);\n    };\n    return PDFPageEmbedder;\n}());\nexport default PDFPageEmbedder;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}