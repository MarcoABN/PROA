{"ast":null,"code":"import PDFDict from \"../objects/PDFDict\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFStream from \"../objects/PDFStream\";\nimport PDFArray from \"../objects/PDFArray\";\nimport PDFRef from \"../objects/PDFRef\";\nimport PDFNumber from \"../objects/PDFNumber\";\nvar PDFAnnotation = /** @class */function () {\n  function PDFAnnotation(dict) {\n    this.dict = dict;\n  }\n  // This is technically required by the PDF spec\n  PDFAnnotation.prototype.Rect = function () {\n    return this.dict.lookup(PDFName.of('Rect'), PDFArray);\n  };\n  PDFAnnotation.prototype.AP = function () {\n    return this.dict.lookupMaybe(PDFName.of('AP'), PDFDict);\n  };\n  PDFAnnotation.prototype.F = function () {\n    var numberOrRef = this.dict.lookup(PDFName.of('F'));\n    return this.dict.context.lookupMaybe(numberOrRef, PDFNumber);\n  };\n  PDFAnnotation.prototype.getRectangle = function () {\n    var _a;\n    var Rect = this.Rect();\n    return (_a = Rect === null || Rect === void 0 ? void 0 : Rect.asRectangle()) !== null && _a !== void 0 ? _a : {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    };\n  };\n  PDFAnnotation.prototype.setRectangle = function (rect) {\n    var x = rect.x,\n      y = rect.y,\n      width = rect.width,\n      height = rect.height;\n    var Rect = this.dict.context.obj([x, y, x + width, y + height]);\n    this.dict.set(PDFName.of('Rect'), Rect);\n  };\n  PDFAnnotation.prototype.getAppearanceState = function () {\n    var AS = this.dict.lookup(PDFName.of('AS'));\n    if (AS instanceof PDFName) return AS;\n    return undefined;\n  };\n  PDFAnnotation.prototype.setAppearanceState = function (state) {\n    this.dict.set(PDFName.of('AS'), state);\n  };\n  PDFAnnotation.prototype.setAppearances = function (appearances) {\n    this.dict.set(PDFName.of('AP'), appearances);\n  };\n  PDFAnnotation.prototype.ensureAP = function () {\n    var AP = this.AP();\n    if (!AP) {\n      AP = this.dict.context.obj({});\n      this.dict.set(PDFName.of('AP'), AP);\n    }\n    return AP;\n  };\n  PDFAnnotation.prototype.getNormalAppearance = function () {\n    var AP = this.ensureAP();\n    var N = AP.get(PDFName.of('N'));\n    if (N instanceof PDFRef || N instanceof PDFDict) return N;\n    throw new Error(\"Unexpected N type: \" + (N === null || N === void 0 ? void 0 : N.constructor.name));\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  PDFAnnotation.prototype.setNormalAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('N'), appearance);\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  PDFAnnotation.prototype.setRolloverAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('R'), appearance);\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  PDFAnnotation.prototype.setDownAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('D'), appearance);\n  };\n  PDFAnnotation.prototype.removeRolloverAppearance = function () {\n    var AP = this.AP();\n    AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('R'));\n  };\n  PDFAnnotation.prototype.removeDownAppearance = function () {\n    var AP = this.AP();\n    AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('D'));\n  };\n  PDFAnnotation.prototype.getAppearances = function () {\n    var AP = this.AP();\n    if (!AP) return undefined;\n    var N = AP.lookup(PDFName.of('N'), PDFDict, PDFStream);\n    var R = AP.lookupMaybe(PDFName.of('R'), PDFDict, PDFStream);\n    var D = AP.lookupMaybe(PDFName.of('D'), PDFDict, PDFStream);\n    return {\n      normal: N,\n      rollover: R,\n      down: D\n    };\n  };\n  PDFAnnotation.prototype.getFlags = function () {\n    var _a, _b;\n    return (_b = (_a = this.F()) === null || _a === void 0 ? void 0 : _a.asNumber()) !== null && _b !== void 0 ? _b : 0;\n  };\n  PDFAnnotation.prototype.setFlags = function (flags) {\n    this.dict.set(PDFName.of('F'), PDFNumber.of(flags));\n  };\n  PDFAnnotation.prototype.hasFlag = function (flag) {\n    var flags = this.getFlags();\n    return (flags & flag) !== 0;\n  };\n  PDFAnnotation.prototype.setFlag = function (flag) {\n    var flags = this.getFlags();\n    this.setFlags(flags | flag);\n  };\n  PDFAnnotation.prototype.clearFlag = function (flag) {\n    var flags = this.getFlags();\n    this.setFlags(flags & ~flag);\n  };\n  PDFAnnotation.prototype.setFlagTo = function (flag, enable) {\n    if (enable) this.setFlag(flag);else this.clearFlag(flag);\n  };\n  PDFAnnotation.fromDict = function (dict) {\n    return new PDFAnnotation(dict);\n  };\n  return PDFAnnotation;\n}();\nexport default PDFAnnotation;\n//# sourceMappingURL=PDFAnnotation.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}