<div class="container-fluid p-2 p-md-3">
  <div class="form-wrapper mx-auto">
    <h2 class="text-center mb-3 mb-md-4">
      <i class="fas fa-file-alt me-2"></i>Serviços
    </h2>

    <!-- Formulário de Pesquisa Compacto -->
        <div class="search-form">
            <form #clienteForm="ngForm" (ngSubmit)="consultarAnexo()">
                <div class="row g-2 g-md-3">
                    <div class="col-12 col-md-4">
                        <label for="cliente" class="form-label small">Cliente (CPF ou CNPJ)</label>
                        <input type="text" class="form-control form-control-sm" id="cliente" #clienteInput
                            [(ngModel)]="cpfcnpjCliente" name="cliente" mask="000.000.000-00 || 00.000.000/0000-00"
                            [dropSpecialCharacters]="false" required />
                    </div>

                    <div class="col-12 col-md-5">
                        <label for="nomeCliente" class="form-label small">Nome</label>
                        <input type="text" class="form-control form-control-sm" id="nomeCliente"
                            [(ngModel)]="nomeCliente" name="nomeCliente" readonly />
                    </div>

                    <div class="col-12 col-md-3 d-flex align-items-end">
                        <div class="col-12 col-md-3 d-flex gap-2">
                            <button type="submit" class="btn btn-primary btn-sm">
                                <i class="fas fa-search me-1"></i>Pesquisar
                            </button>
                            <button type="button" class="btn btn-outline-secondary btn-sm"
                                (click)="limparDados(clienteForm)">
                                <i class="fas fa-eraser me-1"></i>Limpar
                            </button>
                        </div>
                    </div>
                </div>

                <div class="row mt-2 mt-md-3">
                    <div class="col-12">
                        <label for="embarcacao" class="form-label small">Embarcação</label>
                        <select class="form-select form-select-sm" id="embarcacao" [(ngModel)]="idEmbarcacao"
                            name="embarcacao" (change)="onEmbarcacaoChange($event)" required>
                            <option *ngFor="let embarcacao of embarcacoes" [value]="embarcacao.id">
                                {{ embarcacao.nomeEmbarcacao }}
                            </option>
                        </select>
                    </div>
                </div>
            </form>
        </div>

    <br>
    <!-- Seções de Serviços -->
    <div class="row">
      <!-- Serviços de Embarcação -->
      <div class="col-12 mb-4">
        <div class="section-header">
          <i class="fas fa-ship"></i>
          <h4 class="mb-0">Serviços para Embarcações</h4>
        </div>

        <div class="row g-2 g-md-3">
          <!-- Inscrição -->
          <div class="col-12 col-sm-6 col-md-4">
            <div class="card h-100">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="fas fa-file-signature text-primary me-1"></i>
                  Inscrição de Embarcação
                </h5>
                <p class="card-subtitle small text-muted mb-2">(Esporte/Recreio)</p>
                <div class="d-flex justify-content-end gap-2 mt-3">
                  <button 
                    [disabled]="!cliente || !embarcacoes.length" 
                    type="button" 
                    class="btn btn-primary btn-sm w-100" 
                    (click)="ServicoInscEmbTela()">
                    <i class="fas fa-eye me-1"></i>Visualizar
                  </button>
                  <button hidden
                    [disabled]="!cliente || !embarcacoes.length" 
                    type="button" 
                    class="btn btn-primary btn-sm" 
                    (click)="ServicoInscEmbEmail()">
                    <i class="fas fa-paper-plane me-1"></i>Enviar
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Alteração -->
          <div class="col-12 col-sm-6 col-md-4">
            <div class="card h-100">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="fas fa-edit text-success me-1"></i>
                  Alteração de Embarcação
                </h5>
                <p class="card-subtitle small text-muted mb-2">(Esporte/Recreio)</p>
                <div class="d-flex justify-content-end gap-2 mt-3">
                  <button 
                    [disabled]="!cliente || !embarcacoes.length" 
                    type="button" 
                    class="btn btn-primary btn-sm btn-sm w-100" 
                    (click)="ServicoAltcEmbTela()">
                    <i class="fas fa-eye me-1"></i>Visualizar
                  </button>
                  <button hidden
                    [disabled]="!cliente || !embarcacoes.length" 
                    type="button" 
                    class="btn btn-primary btn-sm" 
                    (click)="ServicoAltEmbEmail()">
                    <i class="fas fa-paper-plane me-1"></i>Enviar
                  </button>
                </div>
              </div>
            </div>
          </div>

          
          <!-- Transferência -->
          <div class="col-12 col-sm-6 col-md-4">
            <div class="card h-100">
              <div class="card-body">
                <h5 class="card-title">
                  <i class="fas fa-exchange-alt text-info me-1"></i>
                  Transferência de Embarcação
                </h5>
                <p class="card-subtitle small text-muted mb-2">(Esporte/Recreio)</p>
                <div class="d-flex justify-content-end gap-2 mt-3">
                  <button 
                    [disabled]="!cliente || !embarcacoes.length" 
                    type="button" 
                    class="btn btn-primary btn-sm btn-sm w-100" 
                    (click)="openModal2M(1)">
                    <i class="fas fa-eye me-1"></i>Visualizar
                  </button>
                  <button hidden
                    [disabled]="!cliente || !embarcacoes.length" 
                    type="button" 
                    class="btn btn-primary btn-sm" 
                    (click)="openModal2M(2)">
                    <i class="fas fa-paper-plane me-1"></i>Enviar
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal para Transferência -->
<div class="modal fade" id="modalAnexo2M" tabindex="-1" aria-labelledby="modalAnexo2MLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalAnexo2MLabel">
          <i class="fas fa-exchange-alt me-2"></i>Informações para Transferência
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form #transferenciaForm="ngForm">
          <div class="mb-3">
            <label for="campotexto1" class="form-label small">CPF/CNPJ do Comprador*</label>
            <input type="text" id="campotexto1" class="form-control form-control-sm" 
                   [(ngModel)]="campotexto1" name="campotexto1" required>
            <small class="text-muted">O comprador informado deve estar cadastrado na plataforma.</small>
          </div>
        </form>
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary btn-sm" (click)="confirmarAnexo2M()" 
                [disabled]="!transferenciaForm.form.valid">
          <i class="fas fa-check me-1"></i>Confirmar
        </button>
        <button type="button" class="btn btn-outline-secondary btn-sm" data-bs-dismiss="modal">
          <i class="fas fa-times me-1"></i>Cancelar
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Carregamento -->
<div *ngIf="carregando" class="loading-overlay">
  <div class="loading-content">
    <img src="assets/gifbarco.gif" alt="Carregando..." class="loading-gif">
    <p class="text-muted mt-2">Gerando documento, aguarde...</p>
  </div>
</div>