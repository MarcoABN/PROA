{"ast":null,"code":"import _asyncToGenerator from \"E:/PROA/frontPROA/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { BehaviorSubject } from \"rxjs\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/fire/compat/auth\";\nexport let AutenticacaoService = /*#__PURE__*/(() => {\n  class AutenticacaoService {\n    constructor(http, auth) {\n      this.http = http;\n      this.auth = auth;\n      this.baseUrl = 'http://localhost:3000';\n      this.userSubject = new BehaviorSubject(null);\n      const user = localStorage.getItem('user');\n      if (user) {\n        this.userSubject.next(JSON.parse(user));\n      }\n    }\n    login(userLogin) {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        try {\n          const credential = yield _this.auth.signInWithEmailAndPassword(userLogin.email, userLogin.senha);\n          _this.user = credential.user;\n          _this.setUserSubject(_this.user);\n          return credential.user;\n        } catch (error) {\n          _this.error = error;\n          throw error; // Lança o erro para ser capturado pelo componente\n        }\n      })();\n    }\n\n    setUserSubject(user) {\n      localStorage.setItem('user', JSON.stringify(user));\n      this.userSubject.next(user); // Corrige para userSubject\n    }\n\n    getUser() {\n      return this.userSubject.asObservable();\n    }\n    getRoles() {\n      return this.userSubject.getValue();\n    }\n    logout() {\n      this.userSubject.next(null);\n      localStorage.clear();\n      this.auth.signOut();\n    }\n    resetPassword(email) {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        try {\n          yield _this2.auth.sendPasswordResetEmail(email);\n          alert('Um link para resetar sua senha foi enviado para seu e-mail.');\n        } catch (error) {\n          console.error('Erro ao tentar resetar a senha', error);\n          alert('Erro ao tentar resetar a senha. Verifique se o e-mail está correto.');\n          throw error;\n        }\n      })();\n    }\n    register(userLogin) {\n      var _this3 = this;\n      return _asyncToGenerator(function* () {\n        try {\n          const credential = yield _this3.auth.createUserWithEmailAndPassword(userLogin.email, userLogin.senha);\n          _this3.user = credential.user;\n          _this3.setUserSubject(_this3.user); // Armazena o usuário recém-criado no localStorage\n          return credential.user;\n        } catch (error) {\n          _this3.error = error;\n          throw error; // Lança o erro para ser capturado pelo componente\n        }\n      })();\n    }\n    static #_ = this.ɵfac = function AutenticacaoService_Factory(t) {\n      return new (t || AutenticacaoService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.AngularFireAuth));\n    };\n    static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: AutenticacaoService,\n      factory: AutenticacaoService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n  return AutenticacaoService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}